# SLL模板去质子化修正

## 问题

初始计算结果：
- ALY（乙酰化）: ΔΔG = +2.88 kcal/mol ✅ 合理
- SLL（琥珀酰化）: ΔΔG = +25.61 kcal/mol ❌ 异常高！

**原因分析：**
SLL模板使用了质子化的羧酸形式（-COOH），但在生理pH 7.4下应该是去质子化的羧酸根（-COO⁻）。

## 修正内容

### 1. 结构修改（删除HOP2氢原子）

**质子化形式（错误）：**
```
     O (OU1)
     ║
-C-C-O-H (OU2-HOP2)
  CU
```

**去质子化形式（正确）：**
```
     O⁻ (OU1)
     ║
-C-C-O⁻ (OU2)
  CU
```

- ❌ 删除了HOP2氢原子
- ✅ K04_coords.in: 31个原子（与之前相同，因为我们没有在质子化版本中包含HOP2）

### 2. 电荷修改

#### 羧基电荷变化：

| 原子 | 质子化-COOH | 去质子化-COO⁻ | 变化 |
|------|-------------|--------------|------|
| CU   | +0.7341     | +0.8014      | +0.067 |
| OU1  | -0.5894     | -0.8188      | -0.229 |
| OU2  | -0.5894     | -0.8188      | -0.229 |
| HOP2 | (存在)      | (删除)        | N/A |
| **小计** | **-0.4447** | **-0.8362** | **-0.392** |

#### 总电荷：
- 质子化形式：-0.0677 ≈ 0（接近中性）
- 去质子化形式：-0.4592 ≈ -0.5

**注：** 总电荷不是-1.0是因为：
- 主链N端：-NH2（中性，电荷≈-0.1）
- 主链C端：-COOH（在模板中也是中性）
- 侧链末端：-COO⁻（带-1电荷）
- 净效果：整个残基带负电约-0.5

## 化学原理

### Henderson-Hasselbalch方程：
```
pH = pKa + log([COO⁻]/[COOH])

对于羧基：pKa ≈ 4.5
在pH 7.4下：
7.4 = 4.5 + log([COO⁻]/[COOH])
[COO⁻]/[COOH] ≈ 800:1

结论：99.9%的羧基是去质子化的
```

### 共振结构：
去质子化羧酸根中，两个氧原子等价（共振）：
```
     O⁻         O
     ║    ↔     ║
-C-C-O      -C-C-O⁻
```

因此OU1和OU2的电荷相同：-0.8188

## 文件变化

### 修改的文件：
- `K04_template.in` → 去质子化版本（如果有HOP2定义会被删除）
- `K04_coords.in` → 去质子化版本（CU/OU1/OU2电荷更新）

### 备份的文件：
- `backup/K04_template_protonated.in` - 原质子化版本
- `backup/K04_coords_protonated.in` - 原质子化版本

### 生成的文件：
- `K04_template_deprotonated.in` - 中间文件
- `K04_coords_deprotonated.in` - 中间文件
- `fix_sll_deprotonated.py` - 生成脚本

## 测试结果

```
✓ Template library created
✓ Strand created
✓ B781 can be: LYS, ALY, SLL
✓ ConfSpace created!
✅ SUCCESS!
```

OSPREY成功加载去质子化的SLL模板。

## 预期影响

### 能量计算改进：

1. **溶剂化能量**（EEF1模型）：
   - 去质子化离子的Born能：-60到-80 kcal/mol
   - 质子化中性基团的溶剂化能：较小
   - **预期差异：±30-50 kcal/mol**

2. **静电相互作用**：
   - -COO⁻与周围带正电残基（Arg, Lys）的吸引
   - -COOH主要是偶极相互作用
   - **预期差异：±10-20 kcal/mol**

3. **总体预期**：
   - 之前：ΔΔG = +25.61 kcal/mol（质子化）
   - 预期：ΔΔG = +5~15 kcal/mol（去质子化）
   - 仍然不利，但幅度合理

## 下一步

1. ✅ 模板文件已修正
2. ✅ 测试通过
3. ⏳ 重新提交PAStE计算
4. ⏳ 比较新旧ΔΔG值
5. ⏳ 更新结果邮件

## 关键教训

> **化学正确性 > 文件便利性**
>
> CIF文件提供的是化学标准状态，不一定是生理pH的状态。
> 在生成力场模板时，必须根据：
> - 模拟环境的pH
> - 溶剂模型的假设
> - pKa值
>
> 来调整质子化状态！

---

生成时间：2026-01-07
作者：Claude Code + 用户协作
